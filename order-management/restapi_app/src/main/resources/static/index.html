<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>Order Management Console</title>
	<style>
		* {
			margin: 0;
			padding: 0;
			box-sizing: border-box;
		}

		:root {
			--bg-primary: #0a0a0a;
			--bg-secondary: #121212;
			--bg-card: rgba(30, 30, 30, 0.7);
			--gold: #ffd700;
			--gold-dark: #b8860b;
			--gold-light: #ffed4e;
			--text-primary: #ffffff;
			--text-secondary: #b0b0b0;
			--accent: #ffd700;
			--success: #00ff88;
			--error: #ff4757;
			--shadow: rgba(255, 215, 0, 0.2);
			--glass-bg: rgba(18, 18, 18, 0.6);
			--glass-border: rgba(255, 215, 0, 0.1);
		}

		[data-theme="light"] {
			--bg-primary: #f5f5f5;
			--bg-secondary: #ffffff;
			--bg-card: rgba(255, 255, 255, 0.8);
			--gold: #d4a017;
			--gold-dark: #9a7810;
			--gold-light: #f4c430;
			--text-primary: #1a1a1a;
			--text-secondary: #666666;
			--accent: #d4a017;
			--success: #00b359;
			--error: #e63946;
			--shadow: rgba(212, 160, 23, 0.2);
			--glass-bg: rgba(255, 255, 255, 0.7);
			--glass-border: rgba(212, 160, 23, 0.2);
		}

		@keyframes fadeIn {
			from { opacity: 0; transform: translateY(10px); }
			to { opacity: 1; transform: translateY(0); }
		}

		@keyframes slideIn {
			from { transform: translateX(-20px); opacity: 0; }
			to { transform: translateX(0); opacity: 1; }
		}

		@keyframes glow {
			0%, 100% { box-shadow: 0 0 20px var(--shadow), 0 0 40px var(--shadow); }
			50% { box-shadow: 0 0 30px var(--shadow), 0 0 60px var(--shadow); }
		}

		@keyframes shimmer {
			0% { background-position: -1000px 0; }
			100% { background-position: 1000px 0; }
		}

		body {
			font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
			background: var(--bg-primary);
			color: var(--text-primary);
			line-height: 1.6;
			transition: background 0.3s ease, color 0.3s ease;
			position: relative;
			overflow-x: hidden;
		}

		body::before {
			content: '';
			position: fixed;
			top: -50%;
			left: -50%;
			width: 200%;
			height: 200%;
			background: radial-gradient(circle at 20% 50%, rgba(255, 215, 0, 0.03) 0%, transparent 50%),
						radial-gradient(circle at 80% 80%, rgba(255, 215, 0, 0.05) 0%, transparent 50%);
			animation: rotate 30s linear infinite;
			pointer-events: none;
			z-index: 0;
		}

		@keyframes rotate {
			from { transform: rotate(0deg); }
			to { transform: rotate(360deg); }
		}

		.app {
			display: flex;
			min-height: 100vh;
			position: relative;
			z-index: 1;
		}

		.sidebar {
			width: 260px;
			background: var(--glass-bg);
			backdrop-filter: blur(20px);
			-webkit-backdrop-filter: blur(20px);
			border-right: 1px solid var(--glass-border);
			padding: 2rem 0;
			position: sticky;
			top: 0;
			height: 100vh;
			overflow-y: auto;
			animation: slideIn 0.5s ease;
			box-shadow: 4px 0 24px rgba(0, 0, 0, 0.1);
		}

		.sidebar h1 {
			padding: 0 2rem 1rem;
			font-size: 1.8rem;
			background: linear-gradient(135deg, var(--gold), var(--gold-light));
			-webkit-background-clip: text;
			-webkit-text-fill-color: transparent;
			background-clip: text;
			text-shadow: 0 0 30px var(--shadow);
			font-weight: 700;
			letter-spacing: 1px;
		}

		.sidebar nav ul {
			list-style: none;
		}

		.sidebar nav li {
			padding: 1rem 2rem;
			cursor: pointer;
			transition: all 0.3s ease;
			position: relative;
			overflow: hidden;
			border-left: 3px solid transparent;
		}

		.sidebar nav li::before {
			content: '';
			position: absolute;
			top: 0;
			left: -100%;
			width: 100%;
			height: 100%;
			background: linear-gradient(90deg, transparent, var(--shadow), transparent);
			transition: left 0.5s ease;
		}

		.sidebar nav li:hover::before {
			left: 100%;
		}

		.sidebar nav li:hover {
			background: rgba(255, 215, 0, 0.1);
			color: var(--gold);
			border-left-color: var(--gold);
			transform: translateX(5px);
		}

		.sidebar nav li.active {
			background: linear-gradient(90deg, rgba(255, 215, 0, 0.15), transparent);
			color: var(--gold);
			border-left-color: var(--gold);
			font-weight: 600;
			box-shadow: inset 0 0 20px rgba(255, 215, 0, 0.1);
		}

		.content {
			flex: 1;
			padding: 2rem;
			animation: fadeIn 0.5s ease;
			position: relative;
		}

		.theme-toggle {
			position: fixed;
			top: 2rem;
			right: 2rem;
			width: 60px;
			height: 60px;
			background: var(--glass-bg);
			backdrop-filter: blur(20px);
			border: 2px solid var(--glass-border);
			border-radius: 50%;
			cursor: pointer;
			display: flex;
			align-items: center;
			justify-content: center;
			font-size: 1.5rem;
			transition: all 0.3s ease;
			z-index: 1000;
			box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
		}

		.theme-toggle:hover {
			transform: scale(1.1) rotate(15deg);
			box-shadow: 0 0 30px var(--shadow);
			animation: glow 2s ease-in-out infinite;
		}

		.panel {
			display: none;
			animation: fadeIn 0.4s ease;
		}

		.panel.visible {
			display: block;
		}

		.panel header {
			display: flex;
			justify-content: space-between;
			align-items: center;
			margin-bottom: 2rem;
			padding-bottom: 1rem;
			border-bottom: 2px solid var(--glass-border);
		}

		.panel h2 {
			font-size: 2rem;
			background: linear-gradient(135deg, var(--gold), var(--gold-light));
			-webkit-background-clip: text;
			-webkit-text-fill-color: transparent;
			background-clip: text;
			font-weight: 700;
			margin-bottom: 1.5rem;
		}

		form {
			background: var(--glass-bg);
			backdrop-filter: blur(20px);
			padding: 2rem;
			border-radius: 16px;
			border: 1px solid var(--glass-border);
			margin-bottom: 2rem;
			box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
			transition: all 0.3s ease;
		}

		form:hover {
			transform: translateY(-2px);
			box-shadow: 0 12px 48px rgba(0, 0, 0, 0.15), 0 0 30px var(--shadow);
		}

		.grid-form {
			display: grid;
			grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
			gap: 1.5rem;
		}

		label {
			display: flex;
			flex-direction: column;
			gap: 0.5rem;
			font-weight: 500;
			color: var(--text-secondary);
			transition: color 0.3s ease;
		}

		label:focus-within {
			color: var(--gold);
		}

		input, textarea, select {
			padding: 0.75rem 1rem;
			border: 2px solid var(--glass-border);
			background: rgba(255, 255, 255, 0.05);
			color: var(--text-primary);
			border-radius: 8px;
			font-size: 1rem;
			transition: all 0.3s ease;
			font-family: inherit;
		}

		input:focus, textarea:focus, select:focus {
			outline: none;
			border-color: var(--gold);
			box-shadow: 0 0 0 3px rgba(255, 215, 0, 0.1), 0 0 20px var(--shadow);
			transform: translateY(-2px);
		}

		button {
			padding: 0.875rem 2rem;
			background: linear-gradient(135deg, var(--gold), var(--gold-dark));
			color: var(--bg-primary);
			border: none;
			border-radius: 8px;
			font-size: 1rem;
			font-weight: 600;
			cursor: pointer;
			transition: all 0.3s ease;
			text-transform: uppercase;
			letter-spacing: 1px;
			position: relative;
			overflow: hidden;
			box-shadow: 0 4px 15px var(--shadow);
		}

		button::before {
			content: '';
			position: absolute;
			top: 0;
			left: -100%;
			width: 100%;
			height: 100%;
			background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
			transition: left 0.5s ease;
		}

		button:hover::before {
			left: 100%;
		}

		button:hover {
			transform: translateY(-3px);
			box-shadow: 0 6px 25px var(--shadow);
		}

		button:active {
			transform: translateY(-1px);
		}

		button.danger {
			background: linear-gradient(135deg, var(--error), #c0392b);
		}

		.table-wrapper {
			background: var(--glass-bg);
			backdrop-filter: blur(20px);
			border-radius: 16px;
			padding: 1.5rem;
			border: 1px solid var(--glass-border);
			overflow-x: auto;
			box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
			animation: fadeIn 0.5s ease;
		}

		.table-wrapper.empty {
			text-align: center;
			padding: 3rem;
			color: var(--text-secondary);
		}

		table {
			width: 100%;
			border-collapse: separate;
			border-spacing: 0;
		}

		th {
			background: linear-gradient(135deg, rgba(255, 215, 0, 0.2), rgba(255, 215, 0, 0.1));
			padding: 1rem;
			text-align: left;
			font-weight: 600;
			color: var(--gold);
			text-transform: uppercase;
			font-size: 0.85rem;
			letter-spacing: 1px;
			position: sticky;
			top: 0;
			z-index: 10;
		}

		th:first-child {
			border-top-left-radius: 8px;
		}

		th:last-child {
			border-top-right-radius: 8px;
		}

		td {
			padding: 1rem;
			border-bottom: 1px solid var(--glass-border);
			transition: all 0.3s ease;
		}

		tr {
			transition: all 0.3s ease;
		}

		tr:hover {
			background: rgba(255, 215, 0, 0.05);
			transform: scale(1.01);
			box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
		}

		.card {
			background: var(--glass-bg);
			backdrop-filter: blur(20px);
			border-radius: 16px;
			padding: 2rem;
			border: 1px solid var(--glass-border);
			display: grid;
			grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
			gap: 1.5rem;
			box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
			animation: fadeIn 0.5s ease;
			margin-top: 1rem;
		}

		.card div {
			display: flex;
			flex-direction: column;
			gap: 0.5rem;
			padding: 1rem;
			background: rgba(255, 215, 0, 0.05);
			border-radius: 8px;
			transition: all 0.3s ease;
		}

		.card div:hover {
			background: rgba(255, 215, 0, 0.1);
			transform: translateY(-3px);
			box-shadow: 0 4px 12px var(--shadow);
		}

		.card strong {
			color: var(--gold);
			font-size: 0.85rem;
			text-transform: uppercase;
			letter-spacing: 1px;
		}

		.toast {
			padding: 1rem 1.5rem;
			border-radius: 8px;
			margin-top: 1rem;
			font-weight: 500;
			animation: fadeIn 0.3s ease;
			border-left: 4px solid;
			backdrop-filter: blur(10px);
		}

		.toast.success {
			background: rgba(0, 255, 136, 0.1);
			border-color: var(--success);
			color: var(--success);
		}

		.toast.error {
			background: rgba(255, 71, 87, 0.1);
			border-color: var(--error);
			color: var(--error);
		}

		.result {
			animation: fadeIn 0.4s ease;
		}

		::-webkit-scrollbar {
			width: 10px;
			height: 10px;
		}

		::-webkit-scrollbar-track {
			background: var(--bg-secondary);
		}

		::-webkit-scrollbar-thumb {
			background: linear-gradient(180deg, var(--gold), var(--gold-dark));
			border-radius: 5px;
		}

		::-webkit-scrollbar-thumb:hover {
			background: var(--gold-light);
		}

		@media (max-width: 768px) {
			.app {
				flex-direction: column;
			}

			.sidebar {
				width: 100%;
				height: auto;
				position: relative;
			}

			.theme-toggle {
				top: 1rem;
				right: 1rem;
				width: 50px;
				height: 50px;
			}

			.grid-form {
				grid-template-columns: 1fr;
			}
		}
	</style>
</head>
<body>
	<button class="theme-toggle" id="themeToggle" aria-label="Toggle theme">ðŸŒ™</button>
	
	<div class="app">
		<aside class="sidebar">
			<h1>Orders</h1>
			<nav>
				<ul>
					<li data-target="section-list" class="active">Get All</li>
					<li data-target="section-get">Get By ID</li>
					<li data-target="section-create">Create</li>
					<li data-target="section-update">Update</li>
					<li data-target="section-delete">Delete</li>
					<li data-target="section-status">Check Status</li>
					<li data-target="section-status-filter">Get By Status</li>
					<li data-target="section-payment-filter">Get By Payment</li>
					<li data-target="section-date-filter">Get By Date</li>
				</ul>
			</nav>
		</aside>
		<main class="content">
			<section id="section-list" class="panel visible">
				<header>
					<h2>All Orders</h2>
					<button id="refreshAll" type="button">Refresh</button>
				</header>
				<div id="ordersTableContainer" class="table-wrapper empty">
					<p>No orders fetched yet.</p>
				</div>
			</section>

			<section id="section-get" class="panel">
				<h2>Get Order</h2>
				<form id="formGetOrder">
					<label>Order ID
						<input type="number" name="orderId" required />
					</label>
					<button type="submit">Fetch</button>
				</form>
				<div id="getOrderResult" class="result"></div>
			</section>

			<section id="section-create" class="panel">
				<h2>Create Order</h2>
				<form id="formCreateOrder" class="grid-form">
					<label>Customer Name<input name="customerName" required /></label>
					<label>Customer Contact<input name="customerContact" /></label>
					<label>Description<textarea name="description" required></textarea></label>
					<label>Order Date<input type="date" name="orderDate" /></label>
					<label>Shipping Date<input type="date" name="shippingDate" /></label>
					<label>Delivery Date<input type="date" name="deliveryDate" /></label>
					<label>Status
						<select name="status">
							<option value="PENDING">Pending</option>
							<option value="DISPATCHED">Dispatched</option>
							<option value="DELIVERED">Delivered</option>
						</select>
					</label>
					<label>Delivery Address<textarea name="deliveryAddress" required></textarea></label>
					<label>Quantity<input type="number" name="quantity" min="1" /></label>
					<label>Total Price<input type="number" step="0.01" name="totalPrice" /></label>
					<label>Payment Type
						<select name="paymentType">
							<option value="COD">COD</option>
							<option value="PAID">Paid</option>
						</select>
					</label>
					<label>Order Notes<textarea name="orderNotes"></textarea></label>
					<button type="submit">Create</button>
				</form>
				<div id="createOrderResult" class="result"></div>
			</section>

			<section id="section-update" class="panel">
				<h2>Update Order</h2>
				<p>Provide the ID of the order and the fields you wish to update.</p>
				<form id="formUpdateOrder" class="grid-form">
					<label>Order ID<input type="number" name="id" required /></label>
					<label>Customer Name<input name="customerName" /></label>
					<label>Customer Contact<input name="customerContact" /></label>
					<label>Description<textarea name="description"></textarea></label>
					<label>Order Date<input type="date" name="orderDate" /></label>
					<label>Shipping Date<input type="date" name="shippingDate" /></label>
					<label>Delivery Date<input type="date" name="deliveryDate" /></label>
					<label>Status
						<select name="status">
							<option value="">--</option>
							<option value="PENDING">Pending</option>
							<option value="DISPATCHED">Dispatched</option>
							<option value="DELIVERED">Delivered</option>
						</select>
					</label>
					<label>Delivery Address<textarea name="deliveryAddress"></textarea></label>
					<label>Quantity<input type="number" name="quantity" min="1" /></label>
					<label>Total Price<input type="number" step="0.01" name="totalPrice" /></label>
					<label>Payment Type
						<select name="paymentType">
							<option value="">--</option>
							<option value="COD">COD</option>
							<option value="PAID">Paid</option>
						</select>
					</label>
					<label>Order Notes<textarea name="orderNotes"></textarea></label>
					<button type="submit">Update</button>
				</form>
				<div id="updateOrderResult" class="result"></div>
			</section>

			<section id="section-delete" class="panel">
				<h2>Delete Order</h2>
				<form id="formDeleteOrder">
					<label>Order ID
						<input type="number" name="orderId" required />
					</label>
					<button type="submit" class="danger">Delete</button>
				</form>
				<div id="deleteOrderResult" class="result"></div>
			</section>

			<section id="section-status" class="panel">
				<h2>Check Order Status</h2>
				<form id="formStatusOrder">
					<label>Order ID
						<input type="number" name="orderId" required />
					</label>
					<button type="submit">Check</button>
				</form>
				<div id="statusOrderResult" class="result"></div>
			</section>

			<section id="section-status-filter" class="panel">
				<h2>Orders By Status</h2>
				<form id="formFilterStatus">
					<label>Status
						<select name="status" required>
							<option value="PENDING">Pending</option>
							<option value="DISPATCHED">Dispatched</option>
							<option value="DELIVERED">Delivered</option>
						</select>
					</label>
					<button type="submit">Fetch</button>
				</form>
				<div class="result" id="statusFilterSummary">No data requested yet.</div>
				<div id="statusFilterTable" class="table-wrapper empty">
					<p>No orders to show.</p>
				</div>
			</section>

			<section id="section-payment-filter" class="panel">
				<h2>Orders By Payment</h2>
				<form id="formFilterPayment">
					<label>Payment Type
						<select name="paymentType" required>
							<option value="COD">Cash on Delivery</option>
							<option value="PAID">Paid</option>
						</select>
					</label>
					<button type="submit">Fetch</button>
				</form>
				<div class="result" id="paymentFilterSummary">No data requested yet.</div>
				<div id="paymentFilterTable" class="table-wrapper empty">
					<p>No orders to show.</p>
				</div>
			</section>

			<section id="section-date-filter" class="panel">
				<h2>Orders By Date</h2>
				<form id="formFilterDate" class="grid-form">
					<label>Type
						<select name="timelineType" required>
							<option value="CREATED">Created</option>
							<option value="SHIPPED">Shipped</option>
							<option value="DELIVERED">Delivered</option>
						</select>
					</label>
					<label>Date
						<input type="date" name="timelineDate" required />
					</label>
					<button type="submit">Fetch</button>
				</form>
				<div class="result" id="dateFilterSummary">No data requested yet.</div>
				<div id="dateFilterTable" class="table-wrapper empty">
					<p>No orders to show.</p>
				</div>
			</section>
		</main>
	</div>
	<script>
(() => {
	const API_BASE = "/orders";

	const qs = (sel, scope = document) => scope.querySelector(sel);
	const qsa = (sel, scope = document) => Array.from(scope.querySelectorAll(sel));

	const sidebarItems = qsa(".sidebar li");
	const sections = qsa(".panel");
	const refreshBtn = qs("#refreshAll");
	const themeToggle = qs("#themeToggle");

	const tableContainer = qs("#ordersTableContainer");
	const getOrderResult = qs("#getOrderResult");
	const createOrderResult = qs("#createOrderResult");
	const updateOrderResult = qs("#updateOrderResult");
	const deleteOrderResult = qs("#deleteOrderResult");
	const statusOrderResult = qs("#statusOrderResult");
	const statusFilterSummary = qs("#statusFilterSummary");
	const paymentFilterSummary = qs("#paymentFilterSummary");
	const dateFilterSummary = qs("#dateFilterSummary");
	const statusFilterTable = qs("#statusFilterTable");
	const paymentFilterTable = qs("#paymentFilterTable");
	const dateFilterTable = qs("#dateFilterTable");

	const formGetOrder = qs("#formGetOrder");
	const formCreateOrder = qs("#formCreateOrder");
	const formUpdateOrder = qs("#formUpdateOrder");
	const formDeleteOrder = qs("#formDeleteOrder");
	const formStatusOrder = qs("#formStatusOrder");
	const formFilterStatus = qs("#formFilterStatus");
	const formFilterPayment = qs("#formFilterPayment");
	const formFilterDate = qs("#formFilterDate");

	// Theme toggle
	const savedTheme = localStorage.getItem('theme') || 'dark';
	if (savedTheme === 'light') {
		document.documentElement.setAttribute('data-theme', 'light');
		themeToggle.textContent = 'â˜€ï¸';
	}

	themeToggle.addEventListener('click', () => {
		const current = document.documentElement.getAttribute('data-theme');
		const newTheme = current === 'light' ? 'dark' : 'light';
		document.documentElement.setAttribute('data-theme', newTheme);
		themeToggle.textContent = newTheme === 'light' ? 'â˜€ï¸' : 'ðŸŒ™';
		localStorage.setItem('theme', newTheme);
	});

	sidebarItems.forEach((item) => {
		item.addEventListener("click", () => {
			sidebarItems.forEach((i) => i.classList.remove("active"));
			item.classList.add("active");

			const targetId = item.dataset.target;
			sections.forEach((section) =>
				section.classList.toggle("visible", section.id === targetId)
			);
		});
	});

	refreshBtn.addEventListener("click", async () => {
		await loadAllOrders();
	});

	formGetOrder.addEventListener("submit", async (event) => {
		event.preventDefault();
		const id = event.target.orderId.value.trim();
		if (!id) return;
		const res = await apiRequest(`${API_BASE}/get/${id}`, { method: "GET" });
		renderCard(res, getOrderResult);
	});

	formCreateOrder.addEventListener("submit", async (event) => {
		event.preventDefault();
		const payload = formToPayload(event.target, false);
		await apiRequest(`${API_BASE}/add`, {
			method: "POST",
			body: JSON.stringify(payload),
		});
		showToast("Order created", createOrderResult, true);
		event.target.reset();
		await loadAllOrders();
	});

	formUpdateOrder.addEventListener("submit", async (event) => {
		event.preventDefault();
		const payload = formToPayload(event.target, true);
		await apiRequest(`${API_BASE}/edit`, {
			method: "PUT",
			body: JSON.stringify(payload),
		});
		showToast("Order updated", updateOrderResult, true);
		await loadAllOrders();
	});

	formDeleteOrder.addEventListener("submit", async (event) => {
		event.preventDefault();
		const id = event.target.orderId.value.trim();
		if (!id) return;
		await apiRequest(`${API_BASE}/delete/${id}`, { method: "DELETE" });
		showToast(`Order ${id} deleted`, deleteOrderResult, true);
		event.target.reset();
		await loadAllOrders();
	});

	formStatusOrder.addEventListener("submit", async (event) => {
		event.preventDefault();
		const id = event.target.orderId.value.trim();
		if (!id) return;
		const order = await apiRequest(`${API_BASE}/get/${id}`, {
			method: "GET",
		});
		if (order && order.status) {
			statusOrderResult.innerHTML = `<div class="toast success">Status: ${order.status}</div>`;
		} else {
			statusOrderResult.innerHTML =
				'<div class="toast error">No status available.</div>';
		}
	});

	formFilterStatus?.addEventListener("submit", async (event) => {
		event.preventDefault();
		const status = event.target.status.value;
		await handleFilterRequest(
			`${API_BASE}/status/${status}`,
			`${status} orders`,
			statusFilterSummary,
			statusFilterTable
		);
	});

	formFilterPayment?.addEventListener("submit", async (event) => {
		event.preventDefault();
		const paymentType = event.target.paymentType.value;
		await handleFilterRequest(
			`${API_BASE}/payment/${paymentType}`,
			`${paymentType} payments`,
			paymentFilterSummary,
			paymentFilterTable
		);
	});

	formFilterDate?.addEventListener("submit", async (event) => {
		event.preventDefault();
		const type = event.target.timelineType.value;
		const date = event.target.timelineDate.value;
		if (!date) return;
		const label = `${type.toLowerCase()} on ${date}`;
		await handleFilterRequest(
			`${API_BASE}/timeline?type=${type}&date=${date}`,
			label,
			dateFilterSummary,
			dateFilterTable
		);
	});

	async function loadAllOrders() {
		try {
			const orders = await apiRequest(`${API_BASE}/get`, { method: "GET" });
			renderOrdersTable(orders);
		} catch (error) {
			console.error(error);
			tableContainer.innerHTML =
				'<div class="toast error">Failed to load orders.</div>';
		}
	}

	async function handleFilterRequest(url, label, summaryTarget, tableTarget) {
		try {
			const data = await apiRequest(url, { method: "GET" });
			if (summaryTarget) {
				renderFilterSummary(summaryTarget, label, data.count);
			}
			renderOrdersTable(data.orders, tableTarget);
		} catch (error) {
			console.error(error);
			if (summaryTarget) {
				summaryTarget.innerHTML =
					'<div class="toast error">Failed to load data.</div>';
			}
			renderOrdersTable([], tableTarget);
		}
	}

	function renderFilterSummary(target, label, count) {
		target.innerHTML = `<div class="toast success">${label}: <strong>${count}</strong></div>`;
	}

	function renderOrdersTable(orders, target = tableContainer) {
		if (!target) return;
		if (!orders || !orders.length) {
			target.classList.add("empty");
			target.innerHTML = "<p>No orders available.</p>";
			return;
		}
		target.classList.remove("empty");
		const headers = [
			"ID",
			"Customer",
			"Contact",
			"Description",
			"Status",
			"Quantity",
			"Total Price",
			"Payment",
			"Created",
		];
		const rows = orders
			.map(
				(o) => `
				<tr>
					<td>${safe(o.id)}</td>
					<td>${safe(o.customerName)}</td>
					<td>${safe(o.customerContact)}</td>
					<td>${safe(o.description)}</td>
					<td>${safe(o.status)}</td>
					<td>${safe(o.quantity)}</td>
					<td>${safe(o.totalPrice)}</td>
					<td>${safe(o.paymentType)}</td>
					<td>${formatDateTime(o.createdAt)}</td>
				</tr>`
			)
			.join("");

		target.innerHTML = `
			<table>
				<thead>
					<tr>${headers.map((h) => `<th>${h}</th>`).join("")}</tr>
				</thead>
				<tbody>${rows}</tbody>
			</table>`;
	}

	function renderCard(order, target) {
		if (!order) {
			target.innerHTML = '<div class="toast error">Order not found.</div>';
			return;
		}
		target.innerHTML = `
			<div class="card">
				<div><strong>ID</strong>${safe(order.id)}</div>
				<div><strong>Customer</strong>${safe(order.customerName)}</div>
				<div><strong>Status</strong>${safe(order.status)}</div>
				<div><strong>Quantity</strong>${safe(order.quantity)}</div>
				<div><strong>Total</strong>${safe(order.totalPrice)}</div>
				<div><strong>Payment</strong>${safe(order.paymentType)}</div>
				<div><strong>Ordered</strong>${safe(order.orderDate)}</div>
				<div><strong>Delivery</strong>${safe(order.deliveryDate)}</div>
				<div><strong>Notes</strong>${safe(order.orderNotes)}</div>
			</div>
		`;
	}

	function showToast(message, target, success = true) {
		target.innerHTML = `<span class="toast ${
			success ? "success" : "error"
		}">${message}</span>`;
	}

	async function apiRequest(url, options) {
		const config = {
			headers: { "Content-Type": "application/json" },
			...options,
		};
		const response = await fetch(url, config);
		if (!response.ok) {
			const text = await response.text();
			throw new Error(text || `Request failed: ${response.status}`);
		}
		if (response.status === 204) return null;
		const contentType = response.headers.get("content-type") || "";
		if (contentType.includes("application/json")) {
			return response.json();
		}
		return response.text();
	}

	function formToPayload(form, includeId) {
		const data = Object.fromEntries(new FormData(form).entries());

		const payload = {
			customerName: valueOrNull(data.customerName),
			customerContact: valueOrNull(data.customerContact),
			description: valueOrNull(data.description),
			orderDate: valueOrNull(data.orderDate),
			shippingDate: valueOrNull(data.shippingDate),
			deliveryDate: valueOrNull(data.deliveryDate),
			status: valueOrNull(data.status),
			deliveryAddress: valueOrNull(data.deliveryAddress),
			quantity: valueOrNumber(data.quantity),
			totalPrice: valueOrNumber(data.totalPrice, true),
			paymentType: valueOrNull(data.paymentType),
			orderNotes: valueOrNull(data.orderNotes),
		};

		if (includeId) {
			payload.id = Number(data.id);
		}

		return payload;
	}

	function valueOrNull(value) {
		return value && value.trim().length ? value.trim() : null;
	}

	function valueOrNumber(value, isDecimal = false) {
		if (!value || !value.trim().length) return null;
		return isDecimal ? Number.parseFloat(value) : Number.parseInt(value, 10);
	}

	function safe(value) {
		if (value === null || value === undefined) return "-";
		return String(value);
	}

	function formatDateTime(value) {
		if (!value) return "-";
		try {
			return new Date(value).toLocaleString();
		} catch (e) {
			return value;
		}
	}

	// auto-load orders initially
	loadAllOrders();
})();
	</script>
</body>
</html>